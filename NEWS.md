# SimSpin v2.1.4 News
### Author: Kate Harborne
### Last edit: 03/03/22

Below is a table containing a summary of all changes made to SimSpin, since the date this file was created on 26/08/2021. 

| Date     	| Summary of change                                                                                                                                                                                                                                                                                                                      	| Version 	| Commit                                   	|
|----------	|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|---------	|------------------------------------------	|
| 26/08/21 	| Adjusting the images output from the `build_datacube()` function to have clearer labels -  images until v2.0.3 have been produced as raw particle images before convolution with a PSF,  though this was unclear. To improve, the following changes have been implemented:                                                             	| 2.0.4   	| b6b6089a6295d2a47794be100e04494261e79476 	|
|          	| (1) `raw_images` output as a list of arrays. These images contain the raw binned particle data.  Specific images included depends on the `method` chosen in the `telescope()` function.                                                                                                                                                	|         	|                                          	|
|          	| (2) `observed_images` output as a list of arrays. These images are produced by collapsing the  observed cube to produce kinematic maps. The observed maps from a `method="spectral"` cube  will be `NULL`, as these would be produced using pPXF.                                                                                      	|         	|                                          	|
|          	| Required changes made to `write_FITS_file()` function to deal with the new list format.                                                                                                                                                                                                                                                	|         	|                                          	|
|          	| Tests added include:                                                                                                                                                                                                                                                                                                                   	|         	|                                          	|
|          	| (1) Expecting all output data cubes to have length = 4.                                                                                                                                                                                                                                                                                	|         	|                                          	|
|          	| (2) Expecting all `mode="spectral"` outputs to have `raw_images` as a list, length = 3, and `observed_images = NULL`.                                                                                                                                                                                                                  	|         	|                                          	|
|          	| (3) Expecting all `mode="velocity"` outputs to have `raw_images` as a list, length = 6, and `observed_images` as a list, length = 3.                                                                                                                                                                                                   	|         	|                                          	|
|          	| (4) When `mass_flag=T`, there should be an array image in each of the lists that is called `mass_image` rather than `flux_image`.                                                                                                                                                                                                      	|         	|                                          	|
| 20/09/21 	| ~~Adding in optional Voronoi binning to increase particle counts per pixel. Unfinished at this stage, but introduces no breaking changes. New minor version number will be included once implemented.~~ **Moved to new branch 25/11/21 - dev-Voronoi.**                                                                                	| 2.0.5   	| 2d1dd7f802d67fe9dd286888923f3ac1f9ea5889 	|
| 11/11/21 	| A few updates to `build_datacube()` -                                                                                                                                                                                                                                                                                                  	| 2.0.5   	| 07e9a099c3fdfb5ae4ddbf587a0bf8b191b86f12 	|
|          	| (1) When blurring velocity cubes, objects were being returned with the name `spectral_cube` despite the v2.0.4 updates. This has now been raised in issue #16 and fixed in latest commit.                                                                                                                                              	|         	|                                          	|
|          	| (2) No particles images were generated in spectral mode. This was raised in issue #15 and solved in later commit. Spectral mode will now return an image containing the number of particles per pixel within the `raw_images` header.                                                                                                  	|         	|                                          	|
|          	| (3) Adding these raw images as HDU in the spectral FITS file produced. All raw images included so 4 extra HDU.                                                                                                                                                                                                                         	|         	|                                          	|
|          	| Tests added include:                                                                                                                                                                                                                                                                                                                   	|         	|                                          	|
|          	| (1) Check that in `mode = velocity` and `blur = T`, returned object includes an array named `velocity_cube` and not `spectral_cube`.                                                                                                                                                                                                   	|         	|                                          	|
|          	| (2) Update the number of expected images in the `raw_images` header to be 4 rather than 3 (now with added particle number image for spectral mode).                                                                                                                                                                                    	|         	|                                          	|
| 26/11/21 	| Update to `write_simspin_FITS()` - renaming the keywords in the FITS cubes output (header of HDU = 2) for all output files (i.e.mode = `spectral`, `velocity` and `gas`). Adjusted so that post processing with pPXF is consistent. Thanks @margarita-luna!                                                                            	| 2.0.6   	| 8c8302af61058c6772cbda1d64b3cc578cbeac8f 	|
| 24/01/22 	| Updates to `observing_strategy` -                                                                                                                                                                                                                                                                                                      	| 2.1.0   	|                                          	|
|          	| (1) Allow user to specify the 'pointing' of the telescope relative to the centre of the galaxy. Can be specified using (x,y) offsets in kpc (`pointing_kpc`) or deg (`pointing_deg`). Useful for observing galaxies that are closer to the observer than the aperture width allows for the full object to be seen in one observation.  	|         	|                                          	|
|          	| (2) Modification to input names. Specifying projected distance can now be done in terms of redshift distance, physical distance (i.e. in Mpc) or angular scale (i.e. specifying kpc per arcsecond). These are now called `dist_z`, `dist_Mpc` and `dist_kpc_per_arcsec`. See `?observing_strategy` for more details.                   	|         	|                                          	|
|          	| (3) Break changes avoided by still allowing users to specify `z` to indicate projected distance. A depreciation warning will also be issues when specifying `z` rather than `dist_z` however.                                                                                                                                          	|         	|                                          	|
| 03/02/22 	| Update to `write_simspin_FITS()` and `observation()` -                                                                                                                                                                                                                                                                                 	| 2.1.1   	| fe8729b86d9b670ed64ea68a3f3c25433cbcd803 	|
|          	| (1) Adding in the SimSpin version number with which the observation has been run against the keyword `origin`.                                                                                                                                                                                                                         	|         	|                                          	|
|          	| (2) Modifying the output `RA` and `DEC` keywords to allow the user to specify the (x,y,z) position of the simulated galaxy within the simulation box and produce a unique RA/DEC value (assuming the observer sits at (0,0,0) in the box!)                                                                                             	|         	|                                          	|
| 23/02/22 	| Update to `write_simspin_FITS()` and `build_datacube()` -                                                                                                                                                                                                                                                                              	| 2.1.2   	|                                          	|
|          	| (1) Adding the ability to `split_save` to both functions i.e. when the input data includes both the cube and summary images, this mode give the user to option to save all components into seperate files automatically. If "FALSE" (as default), all components will be saved into subsequent HDU's of the output FITS file.          	|         	|                                          	|
|          	| (2) Modifying the EXTNAME for the HDU associated with the "raw" particle data (now prefixed with `"RAW_"`) and the "observed" collapsed velocity data cubes (now prefixed with `"OBS_").`                                                                                                                                              	|         	|                                          	|
|          	| (3) Update to the depends version number of R. Now requires R >= 4.0. This is to enable the generation of a container for the web application of SimSpin.                                                                                                                                                                              	|         	|                                          	|
| 03/03/22 	| *Minor bugfix*. Specifying branch of ProSpect in the remotes installation.                                                                                                                                                                                                                                                             	| 2.1.3   	| a8b45bafa139304ee5d66d559b9b1cb0f510e365 	|
| 14/03/22 	| *Minor bugfix*. Specifying all initialised arrays with the correct type (rather than initiallised `NA`s) to imporve code memory handling and speed.                                                                                                                                                                                    	| 2.1.4   	|  6a4c46fe9da4d2bafbecd1251ae7b97664cba970 |
